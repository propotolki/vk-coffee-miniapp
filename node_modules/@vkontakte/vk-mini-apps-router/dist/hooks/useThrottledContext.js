import { useContext, useEffect, useState } from 'react';
import { ContextThrottleService } from '../services/ContextThrottleService';
import { EventBus } from '../services/EventBus';
export function useThrottledContext(context) {
    const contextValue = useContext(context);
    const contextName = context.displayName ?? '';
    const initialContextData = ContextThrottleService.retrieveContextInfo(contextName, contextValue);
    const [prevValue, setPrevValue] = useState(initialContextData.prevValue);
    const [throttledValue, setThrottledValue] = useState(initialContextData.throttledValue);
    useEffect(() => {
        const unsubscribe = EventBus.subscribe(contextName, (throttleValue, prevValue) => {
            setThrottledValue(throttleValue);
            setPrevValue(prevValue);
        });
        return () => unsubscribe();
    }, []);
    useEffect(() => {
        ContextThrottleService.triggerContextUpdate(contextName, contextValue);
    }, [contextValue, contextName]);
    if (!contextName) {
        console.error('No context display name found');
        return [contextValue, null];
    }
    return [throttledValue, prevValue];
}
//# sourceMappingURL=useThrottledContext.js.map