{"version":3,"sources":["../../../src/components/Removable/Removable.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport { classNames } from '@vkontakte/vkjs';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { getTextFromChildren } from '../../lib/children';\nimport type { HTMLAttributesWithRootRef } from '../../types';\nimport { IconButton } from '../IconButton/IconButton';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { RemovableIos } from './RemovableIos';\nimport styles from './Removable.module.css';\n\nexport interface RemovableProps {\n  /**\n   * Текст кнопки удаления ячейки. Визуально скрыт везде, кроме iOS. На iOS появляется в выезжающей кнопке для удаления ячейки.\n   */\n  removePlaceholder?: React.ReactNode;\n  /**\n   * Обработчик, срабатывающий при нажатии на контрол удаления.\n   */\n  onRemove?: (e: React.MouseEvent, rootEl?: HTMLElement | null) => void;\n  /**\n   * Передает атрибут `data-testid` для кнопки, которая активирует кнопку удаления (iOS only).\n   */\n  toggleButtonTestId?: string;\n  /**\n   * Передает атрибут `data-testid` для кнопки удаления.\n   */\n  removeButtonTestId?: string;\n  /**\n   * Блокировка взаимодействия с компонентом.\n   */\n  disabled?: boolean;\n}\n/* eslint-disable jsdoc/require-jsdoc */\ninterface RemovableCommonOwnProps\n  extends Pick<\n    RemovableOwnProps,\n    'noPadding' | 'children' | 'removeButtonTestId' | 'disabled' | 'indent'\n  > {\n  removePlaceholderString?: string;\n  onRemoveClick: (e: React.MouseEvent) => void;\n}\n/* eslint-enable jsdoc/require-jsdoc */\n\nconst RemovableCommon = ({\n  noPadding,\n  children,\n  removePlaceholderString,\n  onRemoveClick,\n  removeButtonTestId,\n  disabled,\n  indent,\n}: RemovableCommonOwnProps) => {\n  return (\n    <div\n      className={classNames(\n        styles.content,\n        !noPadding && styles.withPadding,\n        'vkuiInternalRemovable__content',\n      )}\n    >\n      {typeof children === 'function' ? children({ isRemoving: false }) : children}\n\n      {indent ? (\n        <div className={classNames(styles.action, styles.indentation)} />\n      ) : (\n        <IconButton\n          activeMode=\"opacity\"\n          hoverMode=\"opacity\"\n          className={classNames(styles.action, 'vkuiInternalRemovable__action')}\n          onClick={onRemoveClick}\n          label={removePlaceholderString}\n          data-testid={removeButtonTestId}\n          disabled={disabled}\n        >\n          <Icon24Cancel role=\"presentation\" />\n        </IconButton>\n      )}\n      <span className={styles.offset} aria-hidden />\n    </div>\n  );\n};\n\nexport interface RemovableIosRenderProps {\n  /**\n   * Показывает состояние Removable на платформе iOS при нажатии на иконку удаления.\n   * Для имитации поведения на iOS при нажатии на иконку удаления самого удаление не происходит,\n   * контент сдвигается влево и справа выезжает настоящая кнопка \"Удалить\".\n   * Когда контент сдвинут `isRemoving = true`.\n   */\n  isRemoving: boolean;\n}\n\ninterface RemovableOwnProps\n  extends Omit<HTMLAttributesWithRootRef<HTMLDivElement>, 'children'>,\n    RemovableProps {\n  /**\n   * Расположение кнопки удаления.\n   */\n  align?: 'start' | 'center';\n  /**\n   * Скрывает кнопку, но оставляет отступ.\n   * @since 5.4.0\n   */\n  indent?: boolean;\n  /**\n   * Убирает базовые отступы для базовой платформы.\n   */\n  noPadding?: boolean;\n  /**\n   * Содержимое. Можно передать функцию для отрисовки.\n   */\n  children?: React.ReactNode | ((renderProps: RemovableIosRenderProps) => React.ReactNode);\n}\n\nexport const Removable = ({\n  children,\n  onRemove,\n  removePlaceholder = 'Удалить',\n  align = 'center',\n  indent = false,\n  toggleButtonTestId,\n  removeButtonTestId,\n  disabled,\n  noPadding,\n  ...restProps\n}: RemovableOwnProps): React.ReactNode => {\n  const platform = usePlatform();\n\n  const onRemoveClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    onRemove?.(e);\n  };\n\n  const removePlaceholderString: string = getTextFromChildren(removePlaceholder);\n\n  return (\n    <RootComponent\n      {...restProps}\n      baseClassName={classNames(\n        platform === 'ios' && styles.ios,\n        align === 'start' && styles.alignStart,\n        indent && styles.indent,\n      )}\n    >\n      {platform === 'ios' ? (\n        <RemovableIos\n          onRemove={onRemoveClick}\n          removePlaceholder={removePlaceholder}\n          removePlaceholderString={removePlaceholderString}\n          toggleButtonTestId={toggleButtonTestId}\n          removeButtonTestId={removeButtonTestId}\n          disabled={disabled}\n          indent={indent}\n        >\n          {children}\n        </RemovableIos>\n      ) : (\n        <RemovableCommon\n          onRemoveClick={onRemoveClick}\n          noPadding={noPadding}\n          removeButtonTestId={removeButtonTestId}\n          removePlaceholderString={removePlaceholderString}\n          disabled={disabled}\n          indent={indent}\n        >\n          {children}\n        </RemovableCommon>\n      )}\n    </RootComponent>\n  );\n};\n"],"names":["React","Icon24Cancel","classNames","usePlatform","getTextFromChildren","IconButton","RootComponent","RemovableIos","RemovableCommon","noPadding","children","removePlaceholderString","onRemoveClick","removeButtonTestId","disabled","indent","div","className","isRemoving","activeMode","hoverMode","onClick","label","data-testid","role","span","aria-hidden","Removable","onRemove","removePlaceholder","align","toggleButtonTestId","restProps","platform","e","preventDefault","baseClassName"],"mappings":"AAAA;;;;;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,YAAY,QAAQ,mBAAmB;AAChD,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,WAAW,QAAQ,6BAA0B;AACtD,SAASC,mBAAmB,QAAQ,wBAAqB;AAEzD,SAASC,UAAU,QAAQ,8BAA2B;AACtD,SAASC,aAAa,QAAQ,oCAAiC;AAC/D,SAASC,YAAY,QAAQ,oBAAiB;AAkC9C,qCAAqC,GAErC,MAAMC,kBAAkB,CAAC,EACvBC,SAAS,EACTC,QAAQ,EACRC,uBAAuB,EACvBC,aAAa,EACbC,kBAAkB,EAClBC,QAAQ,EACRC,MAAM,EACkB;IACxB,qBACE,MAACC;QACCC,WAAWf,qCAET,CAACO,2CACD;;YAGD,OAAOC,aAAa,aAAaA,SAAS;gBAAEQ,YAAY;YAAM,KAAKR;YAEnEK,uBACC,KAACC;gBAAIC,WAAWf;+BAEhB,KAACG;gBACCc,YAAW;gBACXC,WAAU;gBACVH,WAAWf,oCAA0B;gBACrCmB,SAAST;gBACTU,OAAOX;gBACPY,eAAaV;gBACbC,UAAUA;0BAEV,cAAA,KAACb;oBAAauB,MAAK;;;0BAGvB,KAACC;gBAAKR,SAAS;gBAAiBS,aAAW;;;;AAGjD;AAkCA,OAAO,MAAMC,YAAY;QAAC,EACxBjB,QAAQ,EACRkB,QAAQ,EACRC,oBAAoB,SAAS,EAC7BC,QAAQ,QAAQ,EAChBf,SAAS,KAAK,EACdgB,kBAAkB,EAClBlB,kBAAkB,EAClBC,QAAQ,EACRL,SAAS,EAES,WADfuB;QATHtB;QACAkB;QACAC;QACAC;QACAf;QACAgB;QACAlB;QACAC;QACAL;;IAGA,MAAMwB,WAAW9B;IAEjB,MAAMS,gBAAgB,CAACsB;QACrBA,EAAEC,cAAc;QAChBP,qBAAAA,+BAAAA,SAAWM;IACb;IAEA,MAAMvB,0BAAkCP,oBAAoByB;IAE5D,qBACE,KAACvB,uDACK0B;QACJI,eAAelC,WACb+B,aAAa,+BACbH,UAAU,wCACVf;kBAGDkB,aAAa,sBACZ,KAAC1B;YACCqB,UAAUhB;YACViB,mBAAmBA;YACnBlB,yBAAyBA;YACzBoB,oBAAoBA;YACpBlB,oBAAoBA;YACpBC,UAAUA;YACVC,QAAQA;sBAEPL;2BAGH,KAACF;YACCI,eAAeA;YACfH,WAAWA;YACXI,oBAAoBA;YACpBF,yBAAyBA;YACzBG,UAAUA;YACVC,QAAQA;sBAEPL;;;AAKX,EAAE"}